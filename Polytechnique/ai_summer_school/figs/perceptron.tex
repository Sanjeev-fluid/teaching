
\input{../headerbeamer.sty}
\input{../header.sty}
\usepackage{pdfpages}
\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}
\tikzset{
	treenode/.style = {align=center, inner sep=0pt, text centered,
		font=\sffamily},
	arn_n/.style = {treenode, circle, black, draw=black,
		fill=white, text width=1.5em, thin},% arbre rouge noir, noeud noir
	arn_r/.style = {treenode, circle, red, draw=red, 
		text width=1.5em, very thick},% arbre rouge noir, noeud rouge
	arn_b/.style = {treenode, circle,  draw=green, 
		text width=1.5em, very thick},% arbre rouge noir, noeud rouge
	arn_x/.style = {treenode, rectangle, draw=black, thick,
		minimum width=1.5em, minimum height=1.5em},% arbre rouge noir, nil
	arn_Leaf/.style = {treenode, fill = red, minimum size = 12pt, inner sep = 2pt, rectangle, draw=black, very thick, 
		minimum width=1.5em, minimum height=1.5em},% arbre rouge noir, nil
	emph/.style={edge from parent/.style={blue,thick,draw}},
	norm/.style={edge from parent/.style={black,thin,draw}}
}


\def\layersep{2.5cm}
\def\HLOneN{5}
\def\HLTwoN{6}
\def\nFeats{2}
\title[Machine Learning]{Machine Learning II\\
	\small
	Neural Networks
}

\author{E. Scornet and E. Le Pennec}

\date{Winter 2017}

\begin{document}





\vspace{-2cm}
\hspace{1.5cm}
\begin{tikzpicture}[shorten >=0pt,-,draw=black, node distance=\layersep, transform canvas={scale=0.7}]
\tikzstyle{every pin edge}=[-, draw = black!30]
\tikzstyle{neuron}=[circle,  draw=black,
fill=white, minimum size=14pt,  inner sep=0pt,  font=\sffamily]

\tikzstyle{input neuron}=[neuron];
\tikzstyle{branch neuron}=[neuron, draw=green, very thick, fill = white, minimum size = 16pt, inner sep = 2pt]
\tikzstyle{invisible neuron}=[circle, draw = white]

\tikzstyle{leaf neuron}=[rectangle,  draw=black,
fill=white, minimum size=14pt,  inner sep=0pt,  font=\sffamily]


\tikzstyle{special leaf neuron} = [rectangle, draw=black, very thick, fill = red, minimum size = 16pt, inner sep = 2pt]
\tikzstyle{output neuron}=[circle,  draw=red,
fill=white, minimum size=14pt,  inner sep=0pt,  font=\sffamily];
\tikzstyle{output neuron bis}==[rectangle,  draw=black,
fill=white, minimum size=14pt,  inner sep=4pt,  font=\sffamily];

\tikzstyle{hidden neuron}=[neuron];
\tikzstyle{annot} = [text width=8em, text centered, font = \footnotesize]


% Draw the input layer nodes
\node[input neuron] (I-1) at (\layersep,-1.5) {$x_{1}$};
\node[input neuron] (I-2) at (\layersep,-2.5) {$x_{2}$};
\node[invisible neuron] (I-3) at (\layersep,-3.5)  {$\hdots$};
\node[input neuron] (I-d) at (\layersep,-4.5) {$x_{d}$};

%Define the bias node
\node[leaf neuron] (I-b) at (1.8*\layersep,-0.7) {$b$};


% Draw the hidden layer nodes HL1

\path[yshift=0.5cm]
node[hidden neuron] (HL1-3) at (2.5*\layersep,-3.5 cm) {};
\node[invisible neuron] (II-1) at (3.2*\layersep,-3cm) {};
% Connect every node in the input layer with every node in the
% hidden layer.


\draw (I-1) -- (HL1-3) node [midway, above] (TextNode) {$w_1$};
\draw (I-2) -- (HL1-3) node [midway, above] (TextNode) {$w_2$};
\draw (I-d) -- (HL1-3) node [midway, above] (TextNode) {$w_d$};
\draw (I-b) -- (HL1-3) node [midway, right] (TextNode) {$b$};	
\draw [->] (HL1-3) -- (II-1) node [above] (TextNode) {$\sigma(\sum_{i=1}^d w_i x_i +b )$};	
% Annotate the layers
\node[annot,above of=HL1-3, node distance=3.2cm] (hl1) { Output layer};
\node[annot,left of=hl1, node distance=3.9cm] {Input layer};


\end{tikzpicture}
\end{document}